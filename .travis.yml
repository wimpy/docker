services:
  - docker

env:
  global:
    - secure: "aIbEqWJLO/pC3Ze3okXEADK6DC4VyoLnZUGQQZ/2bWmkQsd4FnXF4kmvYTJcdtcLE8HrRTJK/Mv4YfMntOXnBdTu9H9X/2bSWB08cWF5VK1fVVMjCrZ7Di7v01KiwA0S+0PBD1VeIXvbW9RMLSkUzxEkLMtT/NsFDrMnVE/xNXwCfd+UF1DGrydO6LR6V81jIk+f1MlWmHnXIOohSdvEMC+LgFsgt9ZsePVYsd59jyahiCLRux9DZNFbp+SSTOG19Scdn09Vj/mf2sRgeXgUZpuiYxy2XkFpSLQ7+gphzg1NEK+r8zcy2dFuk58/ikWIQWLn2ZZoVQGquOnzwkHgD/Er2yrswoJinRtCY9f2CMcBOZ94t9OoL3KGxak0xKG0N9ZDKjcYRQSaq3tLwutg0xvv1ddqW3NeEvTICVBRwgyFBgIT5aBqVxRbjZskOPlOHD/xawZx4OgPux3Q7lCGDQt0MUKptDpeexA4v7LWuymAXl7eGU7aGRH0L95Hc4s2a05/BjrIhyea1n07ynXYZA8Muhp/dQK//NuBBXzt7w2OaxjC5ledZuCTvYjHAgbfCwb4kcQHv/GMGdqDcY7y6BQ6aX1r1WOUB+fYVCmH30jMfIv5VwO9uECuCIdQKEyRlvQ4SQr6E/YRGfm0X+9Oe/NJcCJdJTHcsIqlyGxvfCQ=" # DOCKER_EMAIL
    - secure: "eaBu/9iLZwrc6Ly/sadgbeEMCfPeUNClLq53hK4g/fwwJNONJLaVsA9dYIZCMBwOeqvF55NN8LnXf7UgGQS9CXY+mMuS2UmcSerlxk5yBkBUYQWqdxn23PEjh5zjnmb2leE5cHasov8+HUUb+EBLyl8dGn5ZjvFWOfgXEmRVry+nw7GdMhfa/mB+s7VH7uWAHir+UPDTnTks1jUH3zYhhYwEhMwT2iPUPdv9Wi69VyVCaevpzTc8yCDe0S0vrCLwKMBarDzZXLeLsvYfXO5OcV2q01YQVOuWBOLQYp5gmMy2b4GpxcdqYs3VHMnkfwzDp2KPpJHY0kQRKrtixbnzxSRPFz0P2L/9ev2mMdwlTHuAMWO37KjYlj6lPW49sZCJlcED/O8c/4QBw5LgZAo8tH3IZBhKA1fIh5Iha+gC5IDISmJDYUiyIsW94Et1KSR6cjDx0vcN20sGXWRFvfj58i55cWS4eejT3bLZHOfYC30YkHOUfn5sRzssslSIetVTzMxuXrp4Z8gorUJvECH4WXtwyYQj8cUTLiskH75U8zT1saZTcHr9T4A3PTht8MWy5qmjdZWOEtC+NTIv5VdaIabjGpXSKASYSvKkma9nonhLqRe52obi7b94u0EN1MxfZcOaKwdashImHKw2je9wdC6kQPJZb00S9uShVvK/nf0=" # DOCKER_USER
    - secure: "A6YixmZWcH7MltKll1YP9RSEbcEyE4eBSYiW3xO8VGMWxgYQAcF3azNMchSbfkbN4pA4V+K0dnevZwJXZRLpAb9+OCMpiBm8QSKVdBAW97TVHfwfPWC6oeNNYRcxGkkMvH3p3cj9z+96fRs5fuK1a7D7QXHcBSITAlO+8l8lfEIaZzz3TmvUzdxJIzejIT32E1UJqeFGamZk518phAOKdb0JgUFDqhBOgW5j0sdnSbhvwU6C0tJWRnbE8tvvrmu5vE3BFsLoG3jFLBf958o6nkrBK4Rx1ApH0e4V/F9zVCA4zCDwFLluOOSq8UaEuKcWzoHQxL3VcWao12P9uL/pjNkGl91ZiuWuI2iO09FEkmYLJbwAm//OofIGLgKGoUCBz4i7fc38WGHKpUR6LxWq2AgbL3gp8NjvPw8jI5oKkGoBInpMyUCCGn1fk0VknL70N1NBNTPSQwsNZFTQWSStPYPdbOHN1uzow183uBYxBQfXO1fUH649iHMr/lt3rocWwvAP/+WgzMNLPxVlnjQI/Ram51McbQ8Gz//uBGPd55etvXneYRXS425GNRWVKealboM6+yMm6JdYzuCH5xv0HYflbBzAiRYiGY1fKNkeNsYKSO5pbaxPrbmvlk2r5LDfiQ1RArb3Er83IoZ9Xvrl5ojtzBPKoTgL85rsDzUkrCk=" # DOCKER_PASS

script:
  - export REPO=fiunchinho/wimpy
  - export TAG=`if [ -z "${TRAVIS_TAG}" ]; then echo "latest"; else echo "${TRAVIS_TAG}" ; fi`
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - docker build -t ${REPO}:latest .
  - docker tag $REPO:latest $REPO:$TAG
  - docker push $REPO
