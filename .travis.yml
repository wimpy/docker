services:
  - docker

env:
  global:
    - secure: "aIbEqWJLO/pC3Ze3okXEADK6DC4VyoLnZUGQQZ/2bWmkQsd4FnXF4kmvYTJcdtcLE8HrRTJK/Mv4YfMntOXnBdTu9H9X/2bSWB08cWF5VK1fVVMjCrZ7Di7v01KiwA0S+0PBD1VeIXvbW9RMLSkUzxEkLMtT/NsFDrMnVE/xNXwCfd+UF1DGrydO6LR6V81jIk+f1MlWmHnXIOohSdvEMC+LgFsgt9ZsePVYsd59jyahiCLRux9DZNFbp+SSTOG19Scdn09Vj/mf2sRgeXgUZpuiYxy2XkFpSLQ7+gphzg1NEK+r8zcy2dFuk58/ikWIQWLn2ZZoVQGquOnzwkHgD/Er2yrswoJinRtCY9f2CMcBOZ94t9OoL3KGxak0xKG0N9ZDKjcYRQSaq3tLwutg0xvv1ddqW3NeEvTICVBRwgyFBgIT5aBqVxRbjZskOPlOHD/xawZx4OgPux3Q7lCGDQt0MUKptDpeexA4v7LWuymAXl7eGU7aGRH0L95Hc4s2a05/BjrIhyea1n07ynXYZA8Muhp/dQK//NuBBXzt7w2OaxjC5ledZuCTvYjHAgbfCwb4kcQHv/GMGdqDcY7y6BQ6aX1r1WOUB+fYVCmH30jMfIv5VwO9uECuCIdQKEyRlvQ4SQr6E/YRGfm0X+9Oe/NJcCJdJTHcsIqlyGxvfCQ=" # DOCKER_EMAIL
    - secure: "eaBu/9iLZwrc6Ly/sadgbeEMCfPeUNClLq53hK4g/fwwJNONJLaVsA9dYIZCMBwOeqvF55NN8LnXf7UgGQS9CXY+mMuS2UmcSerlxk5yBkBUYQWqdxn23PEjh5zjnmb2leE5cHasov8+HUUb+EBLyl8dGn5ZjvFWOfgXEmRVry+nw7GdMhfa/mB+s7VH7uWAHir+UPDTnTks1jUH3zYhhYwEhMwT2iPUPdv9Wi69VyVCaevpzTc8yCDe0S0vrCLwKMBarDzZXLeLsvYfXO5OcV2q01YQVOuWBOLQYp5gmMy2b4GpxcdqYs3VHMnkfwzDp2KPpJHY0kQRKrtixbnzxSRPFz0P2L/9ev2mMdwlTHuAMWO37KjYlj6lPW49sZCJlcED/O8c/4QBw5LgZAo8tH3IZBhKA1fIh5Iha+gC5IDISmJDYUiyIsW94Et1KSR6cjDx0vcN20sGXWRFvfj58i55cWS4eejT3bLZHOfYC30YkHOUfn5sRzssslSIetVTzMxuXrp4Z8gorUJvECH4WXtwyYQj8cUTLiskH75U8zT1saZTcHr9T4A3PTht8MWy5qmjdZWOEtC+NTIv5VdaIabjGpXSKASYSvKkma9nonhLqRe52obi7b94u0EN1MxfZcOaKwdashImHKw2je9wdC6kQPJZb00S9uShVvK/nf0=" # DOCKER_USER
    - secure: "OJ6Dy+RqPXJxaiT3CWiaJxEzlpczEpANWd30hNoLJJSyihQT7kdHHXwdtX/Pu6FDQElkt5kwk3h7Rq2R/k7aL5CQsfJOfUwVgZV4x7eSP9cytOCiEQqfH8QKmCTVIGHXluMMvTt1YQLXj3F3JwLVCuNcjxR0XARflBR+kamywvXyHNyo5CPc8iEE0BwE+EkEYj2GxbuG+qFP+ehvQib+xTWkegvgI5xVoTNtsWzQy/B+zjmN0ZLahf+xN5/JXHfYjmqLw2YCSkAorL0B4EjaODw/4UshcG1Tw93LErDfYqmxjI0FQ/UpBArKPhc8OncR603wnwX/B5ePya4+rOBeTKxEn7abghNoKM5Xff8WJt5T327W5APcF39xwIH6ahNEU5NQZiUtFhXgCYbNtBrHi0wI32IiN3lXSN3kHnzSoDtHhY1R4VNhn16eqA93fea7NeOYPw+UYloW2j2peSzBlsVRJK2+LZlenf78rZYkZNRG5nPlzan5TGjGlr0FTlwp/qVaQqj11NXwlwjt53Np5K9wMDQ76ghYbasdGTDUCQnbNmYFTPTFCxDCxKgfybYbJf/Lp6o7UCIi5bCLkMMvVGPDZhTQ2GpWfcQmKfWZx7vSwsbA/H0Z2WiD2dMYUZKRV9lz45i+jYy0+1tyWaESmA5nM2ECiDmvnmQOuNf5Se0=" # DOCKER_PASS

script:
  - export REPO=fiunchinho/wimpy
  - export TAG=`if [ -z "${TRAVIS_TAG}" ]; then echo "latest"; else echo "${TRAVIS_TAG}" ; fi`
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - docker build -t ${REPO}:latest .
  - docker tag $REPO:latest $REPO:$TAG
  - docker push $REPO
